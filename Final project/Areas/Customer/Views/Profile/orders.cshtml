@using Final_project.Services.Customer
@model PagedResult<order>
@{
    ViewData["Title"] = "Orders";
    var currentPage = (int)Model.PageNumber;
    var totalPages = (int)Model.TotalPages;
    var pageSize = (int)Model.PageSize;
    var sizeOptions = new[] { 2, 5, 10, 20, 50 };
}
<link href="/css/CustomerProfile.css" rel="stylesheet"/>

    <!-- Header (simplified) -->
<partial name="_Header" />

    <div class="container my-4">
        <div class="row">
            <!-- Left Sidebar Navigation -->
           <partial name="_SideBar"/>
            <!-- Main Content Area -->
            <div class="col-md-9">
                <div class="orders-container p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4><i class="fas fa-box-open amazon-orange me-2"></i> Your Orders</h4>
                        <div class="d-flex">
                            <input type="text" id="searchInput" class="form-control me-2" placeholder="Search all orders" style="width: 250px;">
                            <button onclick="search()" class="btn btn-amazon">Search Orders</button>
                        </div>
                    </div>

                    <!-- Order Filter -->
                    <div class="order-filter mb-4">
                        <div class="row">
                            <div class="col-md-3 mb-2">
                                <label class="form-label">Orders placed in</label>
                                <select class="form-select" id="orderDate">
                                <option value="all">All time</option>
                                    <option value="30">Last 30 days</option>
                                    <option value="90">Last 3 months</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-2">
                                <label class="form-label">Order status</label>
                                <select class="form-select" id="orderStatus">
                                    <option value="all">All orders</option>
                                    <option value="pending">Pending</option>
                                    <option value="shipped">Shipped</option>
                                    <option value="delivered">Delivered</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                           
                        </div>
                    </div>

                    <!-- Order List -->
                <div id="orderResults">                 
                    <partial name="_OrdersList" />
                </div>        
                       
                    
                    </div>

                <!-- Pagination -->
                <nav class="d-flex justify-content-between align-items-center my-4">
                    <div class="text-muted small">
                        Showing page @currentPage of @totalPages
                    </div>

                    <ul class="pagination amazon-pagination mb-0">
                        <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                            <a class="page-link" href="?page=@(currentPage - 1)&size=@pageSize" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>

                        @if (totalPages == 0)
                        {
                            <li class="page-item disabled">
                                <a class="page-link">0</a>
                            </li>
                        }
                        else
                        {
                            <!-- Always show first page -->
                            <li class="page-item @(1 == currentPage ? "active" : "")">
                                <a class="page-link" href="?page=1&size=@pageSize">1</a>
                            </li>

                            @if (currentPage > 3)
                            {
                                <li class="page-item disabled">
                                    <span class="page-link">...</span>
                                </li>
                            }

                            @for (int i = Math.Max(2, currentPage - 1); i <= Math.Min(totalPages - 1, currentPage + 1); i++)
                            {
                                <li class="page-item @(i == currentPage ? "active" : "")">
                                    <a class="page-link" href="?page=@i&size=@pageSize">@i</a>
                                </li>
                            }

                            @if (currentPage < totalPages - 2)
                            {
                                <li class="page-item disabled">
                                    <span class="page-link">...</span>
                                </li>
                            }

                            @if (totalPages > 1)
                            {
                                <li class="page-item @(totalPages == currentPage ? "active" : "")">
                                    <a class="page-link" href="?page=@totalPages&size=@pageSize">@totalPages</a>
                                </li>
                            }
                        }

                        <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                            <a class="page-link" href="?page=@(currentPage + 1)&size=@pageSize" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>

                </div>
            </div>
        </div>
    </div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

   <script>
       document.addEventListener('DOMContentLoaded', function() {

        document.addEventListener('DOMContentLoaded', function () {
                  // Search on Enter
            document.getElementById('searchInput').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const searchValue = this.value;
                    filterOrders('search', searchValue);
                }
            });

            });
            });
        });//end of load

       

           function filterOrders(filterName, value) {
            const data = {};
            data[filterName] = value;

            $.ajax({
                url: '/Customer/Profile/Orders',
                type: 'GET',
                data: data,
                success: function (response) {
                    $('#orderResults').html(response);
                },
                error: function (res) {
                    alert("Error: " + res.responseText);
                }
            });
         }

     });//end of load

            function search() {
            }

      
   </script>